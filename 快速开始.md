# GAC Code 状态栏 v2.0 - 快速开始

> **纯配置驱动模式**: 只需编辑配置文件，系统自动工作，无需记忆任何命令！

## 🚀 5分钟快速部署

### 1. 下载项目

```bash
# 克隆到推荐位置
git clone https://github.com/DrayChou/gaccode-statusline.git ~/.claude/scripts/gaccode.com
cd ~/.claude/scripts/gaccode.com

# 或克隆到自定义位置
git clone https://github.com/DrayChou/gaccode-statusline.git
cd gaccode-statusline
```

### 2. 初始化配置

```bash
# 自动创建配置文件
python setup-config.py
```

### 3. 配置Claude Code状态栏

编辑Claude Code配置文件：
- **Windows**: `%APPDATA%\.config\claude-code\settings.json`
- **Mac/Linux**: `~/.config/claude-code/settings.json`

```json
{
  "statusLine": {
    "type": "command",
    "command": "python ~/.claude/scripts/gaccode.com/statusline.py",
    "refreshInterval": 1000
  }
}
```

### 4. 启动测试

```bash
# 直接启动Claude Code
claude
```

**✅ 完成！** 现在您已经拥有了一个带有智能状态栏的Claude Code环境！

## ⚙️ 配置您的API密钥

### 配置API密钥：编辑配置文件

编辑 `data/config/config.json`：

```json
{
  "platforms": {
    "gaccode": {
      "name": "GAC Code",
      "api_base_url": "https://relay05.gaccode.com/claudecode",
      "api_key": "sk-your-api-key",
      "enabled": true
    },
    "deepseek": {
      "name": "DeepSeek", 
      "api_base_url": "https://api.deepseek.com/anthropic",
      "api_key": "sk-your-deepseek-key",
      "enabled": true
    }
  },
  "launcher": {
    "default_platform": "gaccode"
  },
  "statusline": {
    "show_balance": true,
    "show_model": true,
    "show_git_branch": true,
    "layout": "single_line"
  }
}
```

**💡 安全提醒**: 配置文件已添加到 `.gitignore`，不会被意外提交到版本控制。

## 🎯 四种使用模式（自动检测）

系统会根据您的配置自动选择最适合的模式：

### 1. 零配置模式 ⚫
- **触发**: 没有配置任何API密钥
- **显示**: 基本会话信息，无余额显示
- **适用**: 快速试用，演示

```bash
# 显示示例
Model:Claude-3.5-Sonnet Time:13:24:15 Git:main Dir:myproject
```

### 2. 基础模式 🔵
- **触发**: 仅配置GAC Code API密钥
- **显示**: 自动显示GAC Code余额
- **适用**: 只使用GAC Code的用户

```bash
# 显示示例
Model:Claude-3.5-Sonnet Time:13:24:15 GAC.B:2692/12000 Git:main Dir:myproject
```

### 3. 单平台模式 🟢
- **触发**: 设置了默认平台和对应API密钥
- **显示**: 显示指定平台余额
- **适用**: 主要使用某个特定平台

```bash
# DeepSeek示例
Model:deepseek-v3.1 Time:13:24:15 Balance:¥45.60/¥100 Git:main Dir:myproject
```

### 4. 多平台模式 🟡
- **触发**: 配置多平台 + 使用启动脚本
- **显示**: 根据启动参数显示对应平台
- **适用**: 需要在多个平台间切换

```bash
# 切换平台使用
./bin/cc.mp.sh deepseek  # DeepSeek平台
./bin/cc.mp.sh kimi      # Kimi平台
./bin/cc.mp.sh dp        # DeepSeek简写
```

## 🧪 功能验证

### 基础测试

```bash
# 测试状态栏基本功能
echo '{"session_id":"test"}' | python statusline.py

# 测试平台检测（DeepSeek前缀02）
echo '{"session_id":"02abcdef-1234-5678-9012-123456789abc"}' | python statusline.py
```

### 配置验证

```bash
# 验证配置文件格式
python -c "import json; print('✅ Config valid' if json.load(open('data/config/config.json')) else '❌ Config invalid')"

# 验证配置文件加载
python -c "from config import get_config_manager; cm = get_config_manager(); print('✅ Config loaded' if cm.get_config() else '⚪ Config not found')"
```

### 成功标志

如果配置正确，您应该看到类似输出：

```bash
# 零配置模式
Model:Claude-3.5-Sonnet Time:13:24:15 Git:main Dir:myproject

# 配置API密钥后
Model:Claude-3.5-Sonnet Time:13:24:15 GAC.B:2692/12000 Git:main Dir:myproject
```

## 🎨 个性化配置

### 状态栏显示配置

编辑 `data/config/config.json` 中的 `statusline` 部分：

```json
{
  "statusline": {
    "show_balance": true,          // 显示余额信息
    "show_model": true,            // 显示AI模型名
    "show_directory": true,        // 显示当前目录
    "show_git_branch": true,       // 显示Git分支
    "show_time": true,             // 显示当前时间
    "show_session_cost": true,     // 显示会话成本
    "show_today_usage": true,      // 显示今日使用量
    "layout": "single_line"        // 布局：single_line 或 multi_line
  }
}
```

### 平台配置

```json
{
  "platforms": {
    "gaccode": {
      "name": "GAC Code",
      "api_base_url": "https://relay05.gaccode.com/claudecode",
      "api_key": "sk-your-api-key", // 填入您的API密钥
      "enabled": true
    },
    "deepseek": {
      "name": "DeepSeek",
      "api_base_url": "https://api.deepseek.com/anthropic",
      "api_key": "sk-your-api-key", // 填入您的API密钥
      "model": "deepseek-chat",
      "enabled": true
    }
  },
  "launcher": {
    "default_platform": "gaccode"   // 设置默认平台
  }
}
```

## 🔧 高级用法

### 平台切换

```bash
# 临时使用DeepSeek平台
./bin/cc.mp.sh deepseek

# 临时使用Kimi平台
./bin/cc.mp.sh kimi

# 使用平台别名
./bin/cc.mp.sh dp    # DeepSeek
./bin/cc.mp.sh gc    # GAC Code
```

### 会话继续

```bash
# 继续上次会话
./bin/cc.mp.sh --continue

# 指定平台并继续会话
./bin/cc.mp.sh deepseek --continue
```

## ❓ 常见问题

### Q: 状态栏显示不出来？

**A**: 检查以下几点：
1. Python路径是否正确
2. statusline.py文件路径是否正确
3. Claude Code配置文件是否保存
4. 权限是否足够

**调试方法**:
```bash
# 测试Python和脚本
python statusline.py --version 2>/dev/null || echo "❌ Python或脚本路径错误"

# 测试基本功能
echo '{}' | python statusline.py
```

### Q: 状态栏没有余额信息？

**A**: 检查API密钥配置：
1. 配置文件中API密钥是否正确填写
2. 配置文件格式是否正确
3. 网络连接是否正常

**调试方法**:
```bash
# 检查配置文件内容
python -c "from config import get_config_manager; cm = get_config_manager(); print('API Key configured:', bool(cm.get_platform_config('gaccode', {}).get('api_key')))"

# 测试配置加载
python -c "from config import get_config_manager; cm = get_config_manager(); print('✅ Config loaded' if cm else '❌ Config failed')"
```

### Q: 如何切换默认平台？

**A**: 编辑 `data/config/config.json`：
```json
{
  "launcher": {
    "default_platform": "deepseek"  // 改为你想要的平台
  }
}
```

### Q: 支持哪些平台？

**A**: 目前支持：
- **gaccode**: GAC Code（国内Claude API）
- **deepseek**: DeepSeek（深度求索）
- **kimi**: Kimi（月之暗面）
- **siliconflow**: SiliconFlow（硅基流动）

## 🚀 下一步

1. **探索高级功能**: 查看 [完整文档](README.md)
2. **自定义显示**: 修改状态栏显示项目
3. **多平台使用**: 配置多个AI平台
4. **安全增强**: 使用配置文件管理API密钥，确保gitignore保护

## 📞 获得帮助

- 📖 查看 [完整文档](README.md)
- 📋 阅读 [配置指南](CONFIGURATION_GUIDE.md)
- 🐛 报告问题：GitHub Issues
- 💬 讨论交流：GitHub Discussions

---

**记住**：v2.0采用纯配置驱动设计，您只需编辑配置文件，系统就能自动工作！🎉